<!doctype html><html lang=en-us><head><meta charset=utf-8><title>A Brief Intro to Symbolic Expressions in Python | Dan Aukes </title><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1"><meta name=description content="Dan Aukes' personal website"><meta name=author content="Dan Aukes"><meta name=generator content="Hugo 0.122.0"><link rel=stylesheet href=https://www.danaukes.com/plugins/glightbox/css/glightbox.css><link rel=stylesheet href=https://www.danaukes.com/plugins/bootstrap/bootstrap.min.css><link rel=stylesheet href=https://www.danaukes.com/plugins/slick/slick.css><link rel=stylesheet href=https://www.danaukes.com/plugins/themify-icons/themify-icons.css><link rel=stylesheet href=https://www.danaukes.com/plugins/venobox/venobox.css><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/bootstrap-icons@1.5.0/font/bootstrap-icons.css><link rel=stylesheet href=https://www.danaukes.com/scss/style.min.css media=screen><link rel="shortcut icon" href=https://www.danaukes.com/images/favicon.png type=image/x-icon><link rel=icon href=https://www.danaukes.com/images/favicon.png type=image/x-icon><script>(function(e,t,n,s,o,i,a){e.GoogleAnalyticsObject=o,e[o]=e[o]||function(){(e[o].q=e[o].q||[]).push(arguments)},e[o].l=1*new Date,i=t.createElement(n),a=t.getElementsByTagName(n)[0],i.async=1,i.src=s,a.parentNode.insertBefore(i,a)})(window,document,"script","//www.google-analytics.com/analytics.js","ga"),ga("create","","auto"),ga("send","pageview")</script><script>MathJax={tex:{inlineMath:[["$","$"],["\\(","\\)"]],displayMath:[["$$","$$"],["\\[","\\]"]],processEscapes:!0,processEnvironments:!0},options:{skipHtmlTags:["script","noscript","style","textarea","pre"]}},window.addEventListener("load",e=>{document.querySelectorAll("mjx-container").forEach(function(e){e.parentElement.classList+="has-jax"})})</script><script type=text/javascript id=MathJax-script async src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script></head><body><div class=preloader></div><header class=navigation><div class=container><nav class="navbar navbar-expand-lg navbar-white bg-transparent border-bottom pl-0"><a class="navbar-brand mobile-view" href=https://www.danaukes.com><img class=img-fluid src=https://www.danaukes.com/da-small.png alt="Dan Aukes"></a>
<button class="navbar-toggler border-0" type=button data-toggle=collapse data-target=#navigation>
<i class=ti-menu></i></button><div class="collapse navbar-collapse text-center" id=navigation><div class=desktop-view><ul class="navbar-nav mr-auto"><li class=nav-item><a class=nav-link href=https://github.com/danb0b><i class=ti-github></i></a></li><li class=nav-item><a class=nav-link href=https://www.linkedin.com/in/dan-aukes-502995212/><i class=ti-linkedin></i></a></li></ul></div><a class="navbar-brand mx-auto desktop-view" href=https://www.danaukes.com><img class=img-fluid src=https://www.danaukes.com/da-small.png alt="Dan Aukes"></a><ul class=navbar-nav><li class=nav-item><a class=nav-link href=https://www.danaukes.com/work-blog/>Work Blog</a></li><li class=nav-item><a class=nav-link href=https://www.danaukes.com/notebook/>Notebook</a></li><li class=nav-item><a class=nav-link href=https://www.danaukes.com/travel/>Travel</a></li><li class=nav-item><a class=nav-link href=https://www.danaukes.com/recipes/>Recipes</a></li><li class="nav-item dropdown"><a class="nav-link dropdown-toggle" href=# role=button data-toggle=dropdown aria-haspopup=true aria-expanded=false>Misc</a><div class=dropdown-menu><a class=dropdown-item href=https://www.danaukes.com/code/>Code</a>
<a class=dropdown-item href=https://www.danaukes.com/websites/>Websites</a>
<a class=dropdown-item href=https://www.danaukes.com/bookmarks/>Bookmarks</a></div></li></ul><form action=https://www.danaukes.com/search class=d-flex><input class="form-control me-2" id=search-query name=s type=s placeholder=Search aria-label=Search>
<button class="btn btn-outline-success" type=submit><i class="ti-search text-dark"></i></button></form></div></nav></div></header><section class=section-sm><div class=container><div class=row><div class="col-lg-8 mx-auto"><div class=text-center><nav aria-label=breadcrumb><ol class=breadcrumb><li class=breadcrumb-item><a href=https://www.danaukes.com/>Welcome</a></li><li class=breadcrumb-item><a href=https://www.danaukes.com/work-blog/>Work Blog</a></li><li class="breadcrumb-item active"><a href=https://www.danaukes.com/work-blog/2024-05-21-sympy-expressions/>A Brief Intro to Symbolic Expressions in Python</a></li></ol></nav></div><h2>A Brief Intro to Symbolic Expressions in Python</h2><div class="mb-1 post-meta"><span>By Dan Aukes</span></div><ul class=list-inline></ul><img src=https://www.danaukes.com/work-blog/2024-05-21-sympy-expressions/vlcsnap-2024-05-21-14h37m13s218.png class="img-fluid w-100 mb-4" alt="A Brief Intro to Symbolic Expressions in Python"><div class="content mb-5"><h2 id=introduction>Introduction</h2><p>If you like keeping all your computing in one language (and that language is Python), but want some of the equation manipulation capabilities of Mathematica, have you tried Sympy?</p><h2 id=using-sympy-in-expressions>Using Sympy in Expressions</h2><p>The sympy package in Python is useful for forming and working with symbolic expressions rather than literals. A &ldquo;literal&rdquo;, in programming terms, is a numeric value, like <code>1.2</code>. You can assign numeric, literal values to variables in Python natively, and use python expressions to find numeric answers to expressions. But what if you wanted to work with the expression or equation itself? This is where &ldquo;symbolic&rdquo; variables come in.</p><p>To explore this concept, first we should import the sympy package</p><div class=highlight><pre tabindex=0 style=color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>import</span> <span style=color:#111>sympy</span>
</span></span></code></pre></div><p>To create a symbol, we instantiate sympy&rsquo;s <code>Symbol()</code> class. It requires, at minimum, a string to define how the symbol will be reendered</p><div class=highlight><pre tabindex=0 style=color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#111>a</span> <span style=color:#f92672>=</span> <span style=color:#111>sympy</span><span style=color:#f92672>.</span><span style=color:#111>Symbol</span><span style=color:#111>(</span><span style=color:#d88200>&#39;a&#39;</span><span style=color:#111>)</span>
</span></span><span style=display:flex><span><span style=color:#111>b</span> <span style=color:#f92672>=</span> <span style=color:#111>sympy</span><span style=color:#f92672>.</span><span style=color:#111>Symbol</span><span style=color:#111>(</span><span style=color:#d88200>&#39;b&#39;</span><span style=color:#111>)</span>
</span></span></code></pre></div><p>To see how <code>a</code> is rendered in IPython or Jupyter, simply call the variable you stored the symbol in:</p><div class=highlight><pre tabindex=0 style=color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#111>a</span>
</span></span></code></pre></div><p>$\displaystyle a$</p><p>You can see that it is rendered, whenever possible, as a latex-style expression. This also means you can create symbolic variables that use the latex math mode&rsquo;s expansive set of greek symbols. For example</p><div class=highlight><pre tabindex=0 style=color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#111>theta1</span> <span style=color:#f92672>=</span> <span style=color:#111>sympy</span><span style=color:#f92672>.</span><span style=color:#111>Symbol</span><span style=color:#111>(</span><span style=color:#d88200>&#39;</span><span style=color:#8045ff>\\</span><span style=color:#d88200>theta_1&#39;</span><span style=color:#111>)</span>
</span></span><span style=display:flex><span><span style=color:#111>theta1</span>
</span></span></code></pre></div><p>$\displaystyle \theta_{1}$</p><p>Here we have created a symbol, stored in variable <code>theta1</code>, that renders as the greek letter $\theta_1$.</p><blockquote><p>Note that we had to use a double backslash (<code>\\</code>), rather than latex&rsquo;s single backslash. This is due to the fact that Python strings recognize single backslash characters as a flag for writing non-printing characters such as tab and carriage return. In fact, <code>\t</code> renders in a Python string as a tab character. To get around this, Python strings use the double-backslash to indicate strings where a single backslash was desired.</p></blockquote><p>With symbols created, we can now begin to form symbolic expressions.</p><div class=highlight><pre tabindex=0 style=color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#111>c</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>5</span><span style=color:#f92672>*</span><span style=color:#111>a</span><span style=color:#f92672>+</span><span style=color:#ae81ff>3</span><span style=color:#f92672>*</span><span style=color:#111>b</span><span style=color:#f92672>**</span><span style=color:#ae81ff>2</span>
</span></span><span style=display:flex><span><span style=color:#111>c</span>
</span></span></code></pre></div><p>$\displaystyle 5 a + 3 b^{2}$</p><p>In this case, we have stored the <em>symbolid expression</em> $5a+3b^2$ into a Python variable, c. In contrast, if we were working with numeric literal values, the result of a python expression are stored as a numeric value as well.</p><div class=highlight><pre tabindex=0 style=color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#111>d</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>5.5</span>
</span></span><span style=display:flex><span><span style=color:#111>e</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>6</span>
</span></span><span style=display:flex><span><span style=color:#111>f</span> <span style=color:#f92672>=</span> <span style=color:#111>d</span><span style=color:#f92672>+</span><span style=color:#111>e</span>
</span></span><span style=display:flex><span><span style=color:#111>f</span>
</span></span></code></pre></div><pre><code>11.5
</code></pre><div class=highlight><pre tabindex=0 style=color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#111>type</span><span style=color:#111>(</span><span style=color:#111>f</span><span style=color:#111>)</span>
</span></span></code></pre></div><pre><code>float
</code></pre><p>When working with symbolic expressions, it is sometimes useful to list all the &ldquo;atomic&rdquo; values being used in the expression. This helps separate the operands from the operators. The <code>atoms()</code> method is useful for this:</p><div class=highlight><pre tabindex=0 style=color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#111>c</span><span style=color:#f92672>.</span><span style=color:#111>atoms</span><span style=color:#111>()</span>
</span></span></code></pre></div><pre><code>{2, 3, 5, a, b}
</code></pre><p>However, what if we want to list only the symbolic variables, rather than the numeric? We can supply <code>Symbol</code> to <code>atoms()</code> to filter out the symbolic items</p><div class=highlight><pre tabindex=0 style=color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#111>c</span><span style=color:#f92672>.</span><span style=color:#111>atoms</span><span style=color:#111>(</span><span style=color:#111>sympy</span><span style=color:#f92672>.</span><span style=color:#111>Symbol</span><span style=color:#111>)</span>
</span></span></code></pre></div><pre><code>{a, b}
</code></pre><p>We can work with systems of equations by forming expressions or symbolic variables into matrices or vectors. Sympy <code>Matrix()</code> classes are useful for that, but have some differences in the assumed structure of the vectors and matrices you form:</p><div class=highlight><pre tabindex=0 style=color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#111>d</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>5</span><span style=color:#f92672>*</span><span style=color:#111>a</span><span style=color:#f92672>+</span><span style=color:#ae81ff>3</span><span style=color:#f92672>*</span><span style=color:#111>b</span><span style=color:#f92672>-</span><span style=color:#ae81ff>2</span>
</span></span><span style=display:flex><span><span style=color:#111>e</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>6</span><span style=color:#f92672>*</span><span style=color:#111>a</span><span style=color:#f92672>+</span><span style=color:#ae81ff>2</span><span style=color:#f92672>*</span><span style=color:#111>b</span><span style=color:#f92672>-</span><span style=color:#ae81ff>5</span>
</span></span><span style=display:flex><span><span style=color:#111>f</span> <span style=color:#f92672>=</span> <span style=color:#111>sympy</span><span style=color:#f92672>.</span><span style=color:#111>Matrix</span><span style=color:#111>([</span><span style=color:#111>d</span><span style=color:#111>,</span><span style=color:#111>e</span><span style=color:#111>])</span>
</span></span><span style=display:flex><span><span style=color:#111>f</span>
</span></span></code></pre></div><p>$\displaystyle \left[\begin{matrix}5 a + 3 b - 2\\6 a + 2 b - 5\end{matrix}\right]$</p><p>In this case, we formed a 2x1, 2-dimensional matrix. Defined in this way, we can solve the system of equations all at once using <code>sympy.solve()</code>.</p><div class=highlight><pre tabindex=0 style=color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#111>solution</span> <span style=color:#f92672>=</span> <span style=color:#111>sympy</span><span style=color:#f92672>.</span><span style=color:#111>solve</span><span style=color:#111>(</span><span style=color:#111>f</span><span style=color:#111>,(</span><span style=color:#111>a</span><span style=color:#111>,</span><span style=color:#111>b</span><span style=color:#111>))</span>
</span></span><span style=display:flex><span><span style=color:#111>solution</span>
</span></span></code></pre></div><pre><code>{a: 11/8, b: -13/8}
</code></pre><p>Though the answer supplied is numeric, it is important to note that these results are still in a sympy numeric format, hence the rational result rather than a decimal float.</p><p>You can also use sympy&rsquo;s many tools for operating on expressions directly. Creating a well-known expression,</p><div class=highlight><pre tabindex=0 style=color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#111>g</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>3</span><span style=color:#f92672>*</span><span style=color:#111>a</span><span style=color:#f92672>+</span> <span style=color:#ae81ff>4</span><span style=color:#f92672>*</span><span style=color:#111>b</span> <span style=color:#f92672>+</span><span style=color:#ae81ff>7</span><span style=color:#f92672>*</span><span style=color:#111>a</span><span style=color:#f92672>+</span><span style=color:#ae81ff>16</span><span style=color:#f92672>*</span><span style=color:#111>b</span><span style=color:#f92672>-</span><span style=color:#ae81ff>32</span><span style=color:#f92672>*</span><span style=color:#111>a</span><span style=color:#f92672>*</span><span style=color:#111>b</span>
</span></span></code></pre></div><p>We can see that the simplify method is a handy tool for shortening expressions, using a number of approaches under the hood.</p><div class=highlight><pre tabindex=0 style=color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#111>g</span><span style=color:#f92672>.</span><span style=color:#111>simplify</span><span style=color:#111>()</span>
</span></span></code></pre></div><p>$\displaystyle - 32 a b + 10 a + 20 b$</p><p>One of those tools is the <code>expand()</code> method, which can be used on its own.</p><div class=highlight><pre tabindex=0 style=color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#111>g</span> <span style=color:#f92672>=</span> <span style=color:#111>(</span><span style=color:#111>a</span><span style=color:#f92672>+</span><span style=color:#111>b</span><span style=color:#111>)</span><span style=color:#f92672>*</span><span style=color:#111>(</span><span style=color:#111>a</span><span style=color:#f92672>-</span><span style=color:#111>b</span><span style=color:#111>)</span>
</span></span><span style=display:flex><span><span style=color:#111>g</span><span style=color:#f92672>.</span><span style=color:#111>expand</span><span style=color:#111>()</span>
</span></span></code></pre></div><p>$\displaystyle a^{2} - b^{2}$</p><p><code>simplify()</code> also applies trigonometric simplifcations when appropriate:</p><div class=highlight><pre tabindex=0 style=color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#111>f</span> <span style=color:#f92672>=</span> <span style=color:#111>sympy</span><span style=color:#f92672>.</span><span style=color:#111>sin</span><span style=color:#111>(</span><span style=color:#111>theta1</span><span style=color:#111>)</span><span style=color:#f92672>**</span><span style=color:#ae81ff>2</span> <span style=color:#f92672>+</span> <span style=color:#111>sympy</span><span style=color:#f92672>.</span><span style=color:#111>cos</span><span style=color:#111>(</span><span style=color:#111>theta1</span><span style=color:#111>)</span><span style=color:#f92672>**</span><span style=color:#ae81ff>2</span>
</span></span><span style=display:flex><span><span style=color:#111>f</span><span style=color:#f92672>.</span><span style=color:#111>simplify</span><span style=color:#111>()</span>
</span></span></code></pre></div><p>$\displaystyle 1$</p><div class=highlight><pre tabindex=0 style=color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#111>g</span> <span style=color:#f92672>=</span> <span style=color:#111>sympy</span><span style=color:#f92672>.</span><span style=color:#111>sin</span><span style=color:#111>(</span><span style=color:#111>a</span><span style=color:#111>)</span><span style=color:#f92672>*</span><span style=color:#111>sympy</span><span style=color:#f92672>.</span><span style=color:#111>cos</span><span style=color:#111>(</span><span style=color:#111>b</span><span style=color:#111>)</span> <span style=color:#f92672>+</span> <span style=color:#111>sympy</span><span style=color:#f92672>.</span><span style=color:#111>sin</span><span style=color:#111>(</span><span style=color:#111>b</span><span style=color:#111>)</span><span style=color:#f92672>*</span><span style=color:#111>sympy</span><span style=color:#f92672>.</span><span style=color:#111>cos</span><span style=color:#111>(</span><span style=color:#111>a</span><span style=color:#111>)</span>
</span></span><span style=display:flex><span><span style=color:#111>g</span><span style=color:#f92672>.</span><span style=color:#111>simplify</span><span style=color:#111>()</span>
</span></span></code></pre></div><p>$\displaystyle \sin{\left(a + b \right)}$</p><div class=highlight><pre tabindex=0 style=color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#111>g</span> <span style=color:#f92672>=</span> <span style=color:#111>sympy</span><span style=color:#f92672>.</span><span style=color:#111>cos</span><span style=color:#111>(</span><span style=color:#111>a</span><span style=color:#111>)</span><span style=color:#f92672>*</span><span style=color:#111>sympy</span><span style=color:#f92672>.</span><span style=color:#111>cos</span><span style=color:#111>(</span><span style=color:#111>b</span><span style=color:#111>)</span> <span style=color:#f92672>-</span> <span style=color:#111>sympy</span><span style=color:#f92672>.</span><span style=color:#111>sin</span><span style=color:#111>(</span><span style=color:#111>a</span><span style=color:#111>)</span><span style=color:#f92672>*</span><span style=color:#111>sympy</span><span style=color:#f92672>.</span><span style=color:#111>sin</span><span style=color:#111>(</span><span style=color:#111>b</span><span style=color:#111>)</span> 
</span></span><span style=display:flex><span><span style=color:#111>g</span><span style=color:#f92672>.</span><span style=color:#111>simplify</span><span style=color:#111>()</span>
</span></span></code></pre></div><p>$\displaystyle \cos{\left(a + b \right)}$</p><p>As noted above, though, care must be taken when working on matrices and arrays between numpy and sympy. There are differences in the dimensions of structures created between these two packages. For example,</p><div class=highlight><pre tabindex=0 style=color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>import</span> <span style=color:#111>numpy</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#111>v1</span>  <span style=color:#f92672>=</span> <span style=color:#111>sympy</span><span style=color:#f92672>.</span><span style=color:#111>Matrix</span><span style=color:#111>([</span><span style=color:#ae81ff>1</span><span style=color:#111>,</span><span style=color:#ae81ff>2</span><span style=color:#111>,</span><span style=color:#ae81ff>3</span><span style=color:#111>])</span>
</span></span><span style=display:flex><span><span style=color:#111>v2</span>  <span style=color:#f92672>=</span> <span style=color:#111>numpy</span><span style=color:#f92672>.</span><span style=color:#111>array</span><span style=color:#111>([</span><span style=color:#ae81ff>1</span><span style=color:#111>,</span><span style=color:#ae81ff>2</span><span style=color:#111>,</span><span style=color:#ae81ff>3</span><span style=color:#111>])</span>
</span></span><span style=display:flex><span><span style=color:#111>v3</span> <span style=color:#f92672>=</span> <span style=color:#111>numpy</span><span style=color:#f92672>.</span><span style=color:#111>array</span><span style=color:#111>([[</span><span style=color:#ae81ff>1</span><span style=color:#111>,</span><span style=color:#ae81ff>2</span><span style=color:#111>,</span><span style=color:#ae81ff>3</span><span style=color:#111>]])</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#111>print</span><span style=color:#111>(</span><span style=color:#111>v1</span><span style=color:#f92672>.</span><span style=color:#111>shape</span><span style=color:#111>,</span><span style=color:#111>v2</span><span style=color:#f92672>.</span><span style=color:#111>shape</span><span style=color:#111>,</span><span style=color:#111>v3</span><span style=color:#f92672>.</span><span style=color:#111>shape</span><span style=color:#111>)</span>
</span></span></code></pre></div><pre><code>(3, 1) (3,) (1, 3)
</code></pre><p>As you can see, sympy <code>Matrix</code> classes create 2-dimensional matrices with a length of 1 column when supplied by a list. Conversely, <code>numpy</code> arrays, when initialized, need to have the dimensions determined by the number of nested lists. Thus, converting sympy <code>Matrix</code> classes to <code>numpy.array</code> elements must be done with care, to ensure consistency.</p><h3 id=derivatives>Derivatives</h3><p>You can take the partial derivative of expressions or matrices using the <code>diff</code> method.</p><div class=highlight><pre tabindex=0 style=color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#111>h</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span><span style=color:#f92672>*</span><span style=color:#111>a</span><span style=color:#f92672>+</span><span style=color:#ae81ff>2</span><span style=color:#f92672>*</span><span style=color:#111>b</span> <span style=color:#f92672>+</span><span style=color:#ae81ff>3</span><span style=color:#f92672>*</span><span style=color:#111>a</span><span style=color:#f92672>**</span><span style=color:#ae81ff>2</span> <span style=color:#f92672>+</span><span style=color:#ae81ff>5</span><span style=color:#f92672>*</span><span style=color:#111>b</span><span style=color:#f92672>**</span><span style=color:#ae81ff>3</span>
</span></span><span style=display:flex><span><span style=color:#111>h</span><span style=color:#f92672>.</span><span style=color:#111>diff</span><span style=color:#111>(</span><span style=color:#111>a</span><span style=color:#111>)</span>
</span></span></code></pre></div><p>$\displaystyle 6 a + 1$</p><div class=highlight><pre tabindex=0 style=color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#111>w</span> <span style=color:#f92672>=</span> <span style=color:#111>sympy</span><span style=color:#f92672>.</span><span style=color:#111>Matrix</span><span style=color:#111>([</span><span style=color:#111>a</span><span style=color:#111>,</span><span style=color:#111>b</span><span style=color:#111>,</span><span style=color:#ae81ff>3</span><span style=color:#111>])</span>
</span></span><span style=display:flex><span><span style=color:#111>w</span><span style=color:#f92672>.</span><span style=color:#111>diff</span><span style=color:#111>(</span><span style=color:#111>a</span><span style=color:#111>)</span>
</span></span></code></pre></div><p>$\displaystyle \left[\begin{matrix}1\\0\\0\end{matrix}\right]$</p><p>For nx1 matrices (vectors), the <code>jacobian()</code> method is also available, which finds the partial derivatives of a vector with respect to another vector of variables.</p><div class=highlight><pre tabindex=0 style=color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#111>w</span><span style=color:#f92672>.</span><span style=color:#111>jacobian</span><span style=color:#111>(</span><span style=color:#111>sympy</span><span style=color:#f92672>.</span><span style=color:#111>Matrix</span><span style=color:#111>([</span><span style=color:#111>a</span><span style=color:#111>,</span><span style=color:#111>b</span><span style=color:#111>]))</span>
</span></span></code></pre></div><p>$\displaystyle \left[\begin{matrix}1 & 0 \\ 0 & 1 \\ 0 & 0\end{matrix}\right]$</p><p>You can substitute one thing for another using the <code>subs()</code> method. This is useful for evaluating an expression with numerical values</p><div class=highlight><pre tabindex=0 style=color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#111>exp</span> <span style=color:#f92672>=</span> <span style=color:#111>(</span><span style=color:#111>a</span><span style=color:#f92672>+</span><span style=color:#111>b</span><span style=color:#111>)</span><span style=color:#f92672>.</span><span style=color:#111>subs</span><span style=color:#111>({</span><span style=color:#111>a</span><span style=color:#111>:</span><span style=color:#ae81ff>3</span><span style=color:#111>,</span> <span style=color:#111>b</span><span style=color:#111>:</span><span style=color:#ae81ff>4</span><span style=color:#111>})</span>
</span></span><span style=display:flex><span><span style=color:#111>exp</span>
</span></span></code></pre></div><p>$\displaystyle 7$</p><p>Keep in mind that even numerical results of sympy substitutions are sympy numbers and need to be converted to a different data type of a given precision. for example:</p><div class=highlight><pre tabindex=0 style=color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#111>type</span><span style=color:#111>(</span><span style=color:#111>exp</span><span style=color:#111>)</span>
</span></span></code></pre></div><pre><code>sympy.core.numbers.Integer
</code></pre><div class=highlight><pre tabindex=0 style=color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#111>float</span><span style=color:#111>(</span><span style=color:#111>exp</span><span style=color:#111>)</span>
</span></span></code></pre></div><pre><code>7.0
</code></pre><p>You can also use the subs method with matrices. This returns a matrix filled with sympy data types</p><div class=highlight><pre tabindex=0 style=color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#111>w_num</span> <span style=color:#f92672>=</span> <span style=color:#111>w</span><span style=color:#f92672>.</span><span style=color:#111>subs</span><span style=color:#111>({</span><span style=color:#111>a</span><span style=color:#111>:</span><span style=color:#ae81ff>5.5</span><span style=color:#111>,</span><span style=color:#111>b</span><span style=color:#111>:</span><span style=color:#ae81ff>3.2</span><span style=color:#111>})</span>
</span></span><span style=display:flex><span><span style=color:#111>w_num</span>
</span></span></code></pre></div><p>$\displaystyle \left[\begin{matrix}5.5\\3.2\\3\end{matrix}\right]$</p><div class=highlight><pre tabindex=0 style=color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#111>type</span><span style=color:#111>(</span><span style=color:#111>w_num</span><span style=color:#111>)</span>
</span></span></code></pre></div><pre><code>sympy.matrices.dense.MutableDenseMatrix
</code></pre><p>This can be converted into a numpy array, but again, take care to include the datatype in the array&rsquo;s creation to ensure the contents are also converted to your desired data type</p><div class=highlight><pre tabindex=0 style=color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#111>result</span> <span style=color:#f92672>=</span> <span style=color:#111>numpy</span><span style=color:#f92672>.</span><span style=color:#111>array</span><span style=color:#111>(</span><span style=color:#111>w_num</span><span style=color:#111>,</span><span style=color:#111>dtype</span><span style=color:#f92672>=</span><span style=color:#111>numpy</span><span style=color:#f92672>.</span><span style=color:#111>float64</span><span style=color:#111>)</span>
</span></span><span style=display:flex><span><span style=color:#111>result</span>
</span></span></code></pre></div><pre><code>array([[5.5],
       [3.2],
       [3. ]])
</code></pre><iframe width=560 height=315 src="https://www.youtube-nocookie.com/embed/Rrrx-BigrCk?si=n4gIcslWmaGbBOH7" title="YouTube video player" frameborder=0 allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy=strict-origin-when-cross-origin allowfullscreen></iframe></div></div></div></div></section><footer class=text-capitalize><div class=container><div class="row justify-content-center"><div class="col-12 border-top py-4 text-center"></div><div class="col-lg-4 col-sm-6 mb-5 text-center"><h6 class=mb-4>Contact Me</h6><ul class=list-unstyled><li class=mb-3><i class="ti-location-pin mr-3 text-primary"></i>Arizona, USA</li></li></ul></div><div class="col-lg-4 col-sm-6 mb-5 text-center"><h6 class=mb-4>External</h6><ul class=list-unstyled><li class=mb-3><a class=text-dark href=https://github.com/danb0b>personal github</a></li><li class=mb-3><a class=text-dark href=https://www.linkedin.com/in/dan-aukes-502995212/>linkedin</a></li></ul></div><div class="col-lg-4 col-sm-6 mb-5 text-center"><h6 class=mb-4>Quick Links</h6><ul class=list-unstyled><li class=mb-3><a class=text-dark href=https://www.danaukes.com/about/>About</a></li><li class=mb-3><a class=text-dark href=https://idealab-asu.slack.com>IDEAlab Slack</a></li><li class=mb-3><a class=text-dark href=https://www.danaukes.com/contact/>Contact</a></li><li class=mb-3><a class=text-dark href=https://scram-workspace.slack.com>SCRAMbots</a></li><li class=mb-3><a class=text-dark href=https://www.danaukes.com/calendar/>Calendar</a></li><li class=mb-3><a class=text-dark href=https://kaiteki-asu.slack.com>Kaiteki</a></li></ul></div><div class="col-12 mb-5 text-center"><a href=https://www.danaukes.com><img src=https://www.danaukes.com/da-small.png alt="Dan Aukes"></a></div><div class="col-12 mb-5 text-center"><p>| copyright © 2023 Daniel Aukes. All Rights Reserved. |</p><p><a href=https://github.com/danb0b/danb0b.github.io/edit/master/content/work-blog/2024-05-21-sympy-expressions/index.md>Edit this Page</a></p></div></div></div></footer><script>var indexURL="https://www.danaukes.com/index.json"</script><script src=https://www.danaukes.com/plugins/glightbox/js/glightbox.js></script><script src=https://www.danaukes.com/plugins/jQuery/jquery.min.js></script><script src=https://www.danaukes.com/plugins/bootstrap/bootstrap.min.js></script><script src=https://www.danaukes.com/plugins/slick/slick.min.js></script><script src=https://www.danaukes.com/plugins/venobox/venobox.min.js></script><script src=https://www.danaukes.com/plugins/search/fuse.min.js></script><script src=https://www.danaukes.com/plugins/search/mark.js></script><script src=https://www.danaukes.com/plugins/search/search.js></script><script src=https://www.danaukes.com/js/script.min.js></script><script>var lightbox=GLightbox(),lightboxDescription,lightboxVideo,lightboxInlineIframe;lightbox.on("open",e=>{console.log("lightbox opened")}),lightboxDescription=GLightbox({selector:".glightbox2"}),lightboxVideo=GLightbox({selector:".glightbox3"}),lightboxVideo.on("slide_changed",({prev:e,current:t})=>{console.log("Prev slide",e),console.log("Current slide",t);const{slideIndex:s,slideNode:o,slideConfig:i,player:n}=t;n&&(n.ready||n.on("ready",e=>{}),n.on("play",e=>{console.log("Started play")}),n.on("volumechange",e=>{console.log("Volume change")}),n.on("ended",e=>{console.log("Video ended")}))}),lightboxInlineIframe=GLightbox({selector:".glightbox4"})</script></body></html>