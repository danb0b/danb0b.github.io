<!doctype html><html lang=en-us><head><meta charset=utf-8><title>Using Python in a Docker Container | Dan Aukes </title><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1"><meta name=description content="Dan Aukes' personal website"><meta name=author content="Dan Aukes"><meta name=generator content="Hugo 0.147.3"><link rel=stylesheet href=https://www.danaukes.com/plugins/glightbox/css/glightbox.css><link rel=stylesheet href=https://www.danaukes.com/plugins/bootstrap/bootstrap.min.css><link rel=stylesheet href=https://www.danaukes.com/plugins/slick/slick.css><link rel=stylesheet href=https://www.danaukes.com/plugins/themify-icons/themify-icons.css><link rel=stylesheet href=https://www.danaukes.com/plugins/venobox/venobox.css><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/bootstrap-icons@1.5.0/font/bootstrap-icons.css><link rel=stylesheet href=https://www.danaukes.com/scss/style.min.css media=screen><link rel="shortcut icon" href=https://www.danaukes.com/images/favicon.png type=image/x-icon><link rel=icon href=https://www.danaukes.com/images/favicon.png type=image/x-icon><script>(function(e,t,n,s,o,i,a){e.GoogleAnalyticsObject=o,e[o]=e[o]||function(){(e[o].q=e[o].q||[]).push(arguments)},e[o].l=1*new Date,i=t.createElement(n),a=t.getElementsByTagName(n)[0],i.async=1,i.src=s,a.parentNode.insertBefore(i,a)})(window,document,"script","//www.google-analytics.com/analytics.js","ga"),ga("create","","auto"),ga("send","pageview")</script><script>MathJax={tex:{inlineMath:[["$","$"],["\\(","\\)"]],displayMath:[["$$","$$"],["\\[","\\]"]],processEscapes:!0,processEnvironments:!0},options:{skipHtmlTags:["script","noscript","style","textarea","pre"]}},window.addEventListener("load",e=>{document.querySelectorAll("mjx-container").forEach(function(e){e.parentElement.classList+="has-jax"})})</script><script type=text/javascript id=MathJax-script async src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script></head><body><div class=preloader></div><header class=navigation><div class=container><nav class="navbar navbar-expand-lg navbar-white bg-transparent border-bottom pl-0"><a class="navbar-brand mobile-view" href=https://www.danaukes.com/><img class=img-fluid src=https://www.danaukes.com/da-small.png alt="Dan Aukes"></a>
<button class="navbar-toggler border-0" type=button data-toggle=collapse data-target=#navigation>
<i class=ti-menu></i></button><div class="collapse navbar-collapse text-center" id=navigation><div class=desktop-view><ul class="navbar-nav mr-auto"><li class=nav-item><a class=nav-link href=https://github.com/danb0b><i class=ti-github></i></a></li><li class=nav-item><a class=nav-link href=https://www.linkedin.com/in/dan-aukes-502995212/><i class=ti-linkedin></i></a></li></ul></div><a class="navbar-brand mx-auto desktop-view" href=https://www.danaukes.com/><img class=img-fluid src=https://www.danaukes.com/da-small.png alt="Dan Aukes"></a><ul class=navbar-nav><li class=nav-item><a class=nav-link href=https://www.danaukes.com/work-blog/>Work Blog</a></li><li class=nav-item><a class=nav-link href=https://www.danaukes.com/notebook/>Notebook</a></li><li class=nav-item><a class=nav-link href=https://www.danaukes.com/travel/>Travel</a></li><li class=nav-item><a class=nav-link href=https://www.danaukes.com/recipes/>Recipes</a></li><li class="nav-item dropdown"><a class="nav-link dropdown-toggle" href=# role=button data-toggle=dropdown aria-haspopup=true aria-expanded=false>Misc</a><div class=dropdown-menu><a class=dropdown-item href=https://www.danaukes.com/code/>Code</a>
<a class=dropdown-item href=https://www.danaukes.com/websites/>Websites</a>
<a class=dropdown-item href=https://www.danaukes.com/bookmarks/>Bookmarks</a></div></li></ul><form action=https://www.danaukes.com//search class=d-flex><input class="form-control me-2" id=search-query name=s type=s placeholder=Search aria-label=Search>
<button class="btn btn-outline-success" type=submit><i class="ti-search text-dark"></i></button></form></div></nav></div></header><section class=section-sm><div class=container><div class=row><div class="col-lg-8 mx-auto"><div class=text-center><nav aria-label=breadcrumb><ol class=breadcrumb><li class=breadcrumb-item><a href=https://www.danaukes.com/>Welcome</a></li><li class=breadcrumb-item><a href=https://www.danaukes.com/notebook/>Notebook</a></li><li class=breadcrumb-item><a href=https://www.danaukes.com/notebook/docker/>Docker</a></li><li class="breadcrumb-item active"><a href=https://www.danaukes.com/notebook/docker/jupyter-in-docker/>Using Python in a Docker Container</a></li></ol></nav></div><h2>Using Python in a Docker Container</h2><div class="mb-1 post-meta"><span>By Dan Aukes</span></div><ul class=list-inline><li class="list-inline-item mb-3 mr-2 mt-1"><a class="d-block p-2 bg-primary text-white" href=/tags/python class=text-primary>Python</a></li><li class="list-inline-item mb-3 mr-2 mt-1"><a class="d-block p-2 bg-primary text-white" href=/tags/jupyter class=text-primary>Jupyter</a></li><li class="list-inline-item mb-3 mr-2 mt-1"><a class="d-block p-2 bg-primary text-white" href=/tags/docker class=text-primary>Docker</a></li><li class="list-inline-item mb-3 mr-2 mt-1"><a class="d-block p-2 bg-primary text-white" href=/tags/linux class=text-primary>Linux</a></li><li class="list-inline-item mb-3 mr-2 mt-1"><a class="d-block p-2 bg-primary text-white" href=/tags/ubuntu class=text-primary>Ubuntu</a></li></ul><div class="content mb-5"><h2 id=introduction>Introduction</h2><p>This tutorial makes it possible to spin up a container with everything you need to run Python in a Jupyter notebook.</p><h2 id=implementation>Implementation</h2><h3 id=file-structure>File Structure</h3><p>The following is the folder structure of the project.</p><div class=highlight><pre tabindex=0 style=color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>.
</span></span><span style=display:flex><span>├── build
</span></span><span style=display:flex><span>│   └── Dockerfile
</span></span><span style=display:flex><span>├── build.bash
</span></span><span style=display:flex><span>├── code
</span></span><span style=display:flex><span>│   └── your_code.ipynb
</span></span><span style=display:flex><span>├── docker-compose.yaml
</span></span><span style=display:flex><span>└── jupyter-config
</span></span><span style=display:flex><span>    ├── jupyter_server_config.py
</span></span></code></pre></div><h3 id=dockerfile>Dockerfile</h3><p>in <code>./build</code>, create an empty text file called <code>Dockerfile</code>. Paste in the following:</p><div class=highlight><pre tabindex=0 style=color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-dockerfile data-lang=dockerfile><span style=display:flex><span><span style=color:#00a8c8>FROM</span><span style=color:#d88200> python:3.11-bookworm</span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span><span style=color:#00a8c8>WORKDIR</span><span style=color:#d88200> /code</span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span><span style=color:#00a8c8>RUN</span> apt update <span style=color:#f92672>&amp;&amp;</span> apt install -y python3-distutils python3-pip <span style=color:#f92672>&amp;&amp;</span> <span style=color:#8045ff>\
</span></span></span><span style=display:flex><span><span style=color:#8045ff></span>python -m pip install numpy scipy jupyter matplotlib pillow<span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span><span style=color:#75715e>#... add any other packages here</span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span><span style=color:#75715e>#RUN python -m pip install ...</span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span><span style=color:#00a8c8>EXPOSE</span><span style=color:#d88200> 8888 </span><span style=color:#960050;background-color:#1e0010>
</span></span></span></code></pre></div><p>This short script is the recipe to create a new docker &ldquo;image&rdquo;. A docker image is a static, portable, shareable, and minimal operating system, with everything you need to perform typically one task. In this case, the docker image starts from a release of Debian called &ldquo;bookworm&rdquo; with python 3.11 installed on top of it. From this base image, we install the numpy, scipy, jupyter, matplotlib, and pillow packages. This is enough to do some serious computing and plotting!</p><h3 id=build-script>Build Script</h3><p>Next, in the top folder, create a new file called <code>build.bash</code>.</p><div class=highlight><pre tabindex=0 style=color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e>#!/usr/bin/bash
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>docker build ./build/ -t my_jupyter_image
</span></span></code></pre></div><p>To build it for the first time, make it executable with <code>chmod +x build.bash</code>, then run it with</p><div class=highlight><pre tabindex=0 style=color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>. build.bash
</span></span></code></pre></div><p>This will create a new image called &ldquo;my_jupyter_image&rdquo;</p><p>Why do I like to create my own build script? Because if I want to customize how I built the image, I can store that approach in a clearly-labeled file rather than remember I built it a certain way last time. (I can also comment out other approaches in case I want to switch back). There are a lot of other useful build options. For more ideas, see <a href=/notebook/docker/docker-commands/#build-options>here</a></p><h3 id=jupyter-config-file>Jupyter Config File</h3><p>By default, Jupyter lab requires a token for logging on to the website, and normally when you boot up jupyter using <code>jupyter lab</code>, the command line will spit out a link with the token embedded in it. In a (personal) dockerized environment using docker compose, the token is not as easy to find on the command line, because the <code>docker compose -d</code> command will hide output from the container.</p><p>If you want to access the token, you have to access the container&rsquo;s shell using</p><div class=highlight><pre tabindex=0 style=color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>docker <span style=color:#111>exec</span> -it jupyter /bin/bash
</span></span></code></pre></div><p>and then retrieve the token using the following command:</p><div class=highlight><pre tabindex=0 style=color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>jupyter server list
</span></span></code></pre></div><p>However, there is a different way. This config file sets the token and password to empty strings so that you can sign on without any password. in the ./jupyter-config folder, make <code>jupyter_server_config.py</code> with the following code inside:</p><div class=highlight><pre tabindex=0 style=color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#111>c</span><span style=color:#f92672>.</span><span style=color:#111>ServerApp</span><span style=color:#f92672>.</span><span style=color:#111>token</span> <span style=color:#f92672>=</span> <span style=color:#d88200>&#34;&#34;</span>
</span></span><span style=display:flex><span><span style=color:#111>c</span><span style=color:#f92672>.</span><span style=color:#111>ServerApp</span><span style=color:#f92672>.</span><span style=color:#111>password</span> <span style=color:#f92672>=</span> <span style=color:#d88200>&#34;&#34;</span>
</span></span></code></pre></div><blockquote><p><strong>Caution:</strong> as noted in the <a href=https://jupyter-server.readthedocs.io/en/latest/operators/security.html#alternatives-to-token-authentication>documentation</a>, this approach is not intended for publicly accessible docker containers as it is a security issue. For a personal computing project, this should be just fine.</p></blockquote><h2 id=docker-compose>Docker Compose</h2><p>This is the bare-bones implementation. The <code>docker-compose.yaml</code> file starts up a container called jupyter, using the &ldquo;my_jupyter_image&rdquo; image we built above. The docker-compose file can also build the image if needed, and looks for the same dockerfile in the <code>./build</code> folder. We will access the container by the name <code>jupyter</code> when it is running. It will have access to two folders, the jupyter config folder we placed our config file in earlier, as well as a code folder. The locations on our machine are specified in the folder structure above</p><ul><li><code>--no-browser</code> doesn&rsquo;t launch theh browser</li><li><code>--port=8888</code> specifies port 8888 for the website</li><li><code>--allow-root</code> allows the root user to launch it</li><li><code>--ip=0.0.0.0</code> The address the Jupyter server will listen on. Specifying 0.0.0.0 allows the site to be available through docker</li></ul><div class=highlight><pre tabindex=0 style=color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>version</span><span style=color:#111>:</span> <span style=color:#d88200>&#34;3.9&#34;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>services</span><span style=color:#111>:</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>jupyter</span><span style=color:#111>:</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>image</span><span style=color:#111>:</span> <span style=color:#ae81ff>my_jupyter_image:latest</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>build</span><span style=color:#111>:</span> <span style=color:#ae81ff>./build</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>container_name</span><span style=color:#111>:</span> <span style=color:#ae81ff>jupyter</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>volumes</span><span style=color:#111>:</span> 
</span></span><span style=display:flex><span>    - <span style=color:#ae81ff>./jupyter-config:/root/.jupyter</span>
</span></span><span style=display:flex><span>    - <span style=color:#ae81ff>./code:/code</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>command</span><span style=color:#111>:</span> <span style=color:#ae81ff>bash -c &#34;jupyter lab --allow-root --ip=&#39;0.0.0.0&#39; --port=8888 --no-browser&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>ports</span><span style=color:#111>:</span>
</span></span><span style=display:flex><span>      - <span style=color:#ae81ff>8888</span><span style=color:#111>:</span><span style=color:#ae81ff>8888</span>  
</span></span></code></pre></div><h2 id=putting-it-all-together>Putting it all together</h2><p>To bring up your new container, all you have to do is, from the top folder, call</p><div class=highlight><pre tabindex=0 style=color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>docker compose up
</span></span></code></pre></div><p>This will create a new running instance of your image, which we call a &ldquo;container&rdquo; in docker-speak. Once it is loaded and running, navigate in your browser to <code>localhost:8888</code>. A new jupyter lab window will open and provide access to your <code>code/</code> folder and any files already inside.</p><h2 id=future-work>Future work</h2><p>I hope to be able to share more examples of this approach to getting python running, with specific recipes we use in our lab, research, and classroom. Look out for more.</p><h2 id=words-of-warning>Words of warning</h2><p>This solution does not work very well for cases that</p><ul><li>require hardware acceleration</li><li>require opengl</li><li>require PyQt5 or other GUIs</li></ul><p>this all comes down to the fact that docker out of the box does not support guis or connect well to user-specific hardware. I have gotten some workarounds to this, but nothing coherent enough that it provides a general solution to the above problems. So for now, its great for basic computing, but not so great for visualization or accelerated tasks.</p><h2 id=external-resources>External Resources</h2><h3 id=docker-info>Docker info</h3><ul><li><a href=https://towardsdatascience.com/how-to-run-jupyter-notebook-on-docker-7c9748ed209f>https://towardsdatascience.com/how-to-run-jupyter-notebook-on-docker-7c9748ed209f</a></li><li><a href=https://medium.com/@18bhavyasharma/setting-up-and-running-jupyter-notebook-in-a-docker-container-d2acd713ce66>https://medium.com/@18bhavyasharma/setting-up-and-running-jupyter-notebook-in-a-docker-container-d2acd713ce66</a></li><li><a href=https://www.dataquest.io/blog/docker-data-science/>https://www.dataquest.io/blog/docker-data-science/</a></li><li><a href=https://towardsdev.com/run-a-jupyter-notebook-in-a-docker-container-on-your-local-device-80ccd9570e4f>https://towardsdev.com/run-a-jupyter-notebook-in-a-docker-container-on-your-local-device-80ccd9570e4f</a></li></ul><h3 id=about-docker-base-images>About Docker Base Images</h3><ul><li><a href=https://pythonspeed.com/articles/base-image-python-docker-images/>https://pythonspeed.com/articles/base-image-python-docker-images/</a></li></ul><h3 id=jupyter-setup-and-security>Jupyter setup and security</h3><ul><li><a href=https://jupyter-server.readthedocs.io/en/latest/operators/security.html#>https://jupyter-server.readthedocs.io/en/latest/operators/security.html#</a></li><li><a href=https://jupyter-server.readthedocs.io/en/latest/users/configuration.html>https://jupyter-server.readthedocs.io/en/latest/users/configuration.html</a></li></ul></div></div></div></div></section><footer class=text-capitalize><div class=container><div class="row justify-content-center"><div class="col-12 border-top py-4 text-center"></div><div class="col-lg-4 col-sm-6 mb-5 text-center"><h6 class=mb-4>Contact Me</h6><ul class=list-unstyled><li class=mb-3><i class="ti-location-pin mr-3 text-primary"></i>Arizona, USA</li></li></ul></div><div class="col-lg-4 col-sm-6 mb-5 text-center"><h6 class=mb-4>External</h6><ul class=list-unstyled><li class=mb-3><a class=text-dark href=https://github.com/danb0b>personal github</a></li><li class=mb-3><a class=text-dark href=https://www.linkedin.com/in/dan-aukes-502995212/>linkedin</a></li></ul></div><div class="col-lg-4 col-sm-6 mb-5 text-center"><h6 class=mb-4>Quick Links</h6><ul class=list-unstyled><li class=mb-3><a class=text-dark href=https://www.danaukes.com/about/>About</a></li><li class=mb-3><a class=text-dark href=https://idealab-asu.slack.com>IDEAlab Slack</a></li><li class=mb-3><a class=text-dark href=https://www.danaukes.com/contact/>Contact</a></li><li class=mb-3><a class=text-dark href=https://scram-workspace.slack.com>SCRAMbots</a></li><li class=mb-3><a class=text-dark href=https://www.danaukes.com/calendar/>Calendar</a></li><li class=mb-3><a class=text-dark href=https://kaiteki-asu.slack.com>Kaiteki</a></li></ul></div><div class="col-12 mb-5 text-center"><a href=https://www.danaukes.com/><img src=https://www.danaukes.com/da-small.png alt="Dan Aukes"></a></div><div class="col-12 mb-5 text-center"><p>| copyright © 2023 Daniel Aukes. All Rights Reserved. |</p><p><a href=https://github.com/danb0b/danb0b.github.io/edit/master/content/notebook/docker/jupyter-in-docker.md>Edit this Page</a></p></div></div></div></footer><script>var indexURL="https://www.danaukes.com/index.json"</script><script src=https://www.danaukes.com/plugins/glightbox/js/glightbox.js></script><script src=https://www.danaukes.com/plugins/jQuery/jquery.min.js></script><script src=https://www.danaukes.com/plugins/bootstrap/bootstrap.min.js></script><script src=https://www.danaukes.com/plugins/slick/slick.min.js></script><script src=https://www.danaukes.com/plugins/venobox/venobox.min.js></script><script src=https://www.danaukes.com/plugins/search/fuse.min.js></script><script src=https://www.danaukes.com/plugins/search/mark.js></script><script src=https://www.danaukes.com/plugins/search/search.js></script><script src=https://www.danaukes.com/js/script.min.js></script><script>var lightboxDescription,lightboxVideo,lightboxInlineIframe,lightbox=GLightbox();lightbox.on("open",e=>{console.log("lightbox opened")}),lightboxDescription=GLightbox({selector:".glightbox2"}),lightboxVideo=GLightbox({selector:".glightbox3"}),lightboxVideo.on("slide_changed",({prev:e,current:t})=>{console.log("Prev slide",e),console.log("Current slide",t);const{slideIndex:s,slideNode:o,slideConfig:i,player:n}=t;n&&(n.ready||n.on("ready",e=>{}),n.on("play",e=>{console.log("Started play")}),n.on("volumechange",e=>{console.log("Volume change")}),n.on("ended",e=>{console.log("Video ended")}))}),lightboxInlineIframe=GLightbox({selector:".glightbox4"})</script></body></html>