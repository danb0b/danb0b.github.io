<!doctype html><html lang=en-us><head><meta charset=utf-8><title>ASUS Zenbook Issues | Dan Aukes </title><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1"><meta name=description content="Dan Aukes' personal website"><meta name=author content="Dan Aukes"><meta name=generator content="Hugo 0.147.3"><link rel=stylesheet href=https://www.danaukes.com/plugins/glightbox/css/glightbox.css><link rel=stylesheet href=https://www.danaukes.com/plugins/bootstrap/bootstrap.min.css><link rel=stylesheet href=https://www.danaukes.com/plugins/slick/slick.css><link rel=stylesheet href=https://www.danaukes.com/plugins/themify-icons/themify-icons.css><link rel=stylesheet href=https://www.danaukes.com/plugins/venobox/venobox.css><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/bootstrap-icons@1.5.0/font/bootstrap-icons.css><link rel=stylesheet href=https://www.danaukes.com/scss/style.min.css media=screen><link rel="shortcut icon" href=https://www.danaukes.com/images/favicon.png type=image/x-icon><link rel=icon href=https://www.danaukes.com/images/favicon.png type=image/x-icon><script>(function(e,t,n,s,o,i,a){e.GoogleAnalyticsObject=o,e[o]=e[o]||function(){(e[o].q=e[o].q||[]).push(arguments)},e[o].l=1*new Date,i=t.createElement(n),a=t.getElementsByTagName(n)[0],i.async=1,i.src=s,a.parentNode.insertBefore(i,a)})(window,document,"script","//www.google-analytics.com/analytics.js","ga"),ga("create","","auto"),ga("send","pageview")</script><script>MathJax={tex:{inlineMath:[["$","$"],["\\(","\\)"]],displayMath:[["$$","$$"],["\\[","\\]"]],processEscapes:!0,processEnvironments:!0},options:{skipHtmlTags:["script","noscript","style","textarea","pre"]}},window.addEventListener("load",e=>{document.querySelectorAll("mjx-container").forEach(function(e){e.parentElement.classList+="has-jax"})})</script><script type=text/javascript id=MathJax-script async src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script></head><body><div class=preloader></div><header class=navigation><div class=container><nav class="navbar navbar-expand-lg navbar-white bg-transparent border-bottom pl-0"><a class="navbar-brand mobile-view" href=https://www.danaukes.com/><img class=img-fluid src=https://www.danaukes.com/da-small.png alt="Dan Aukes"></a>
<button class="navbar-toggler border-0" type=button data-toggle=collapse data-target=#navigation>
<i class=ti-menu></i></button><div class="collapse navbar-collapse text-center" id=navigation><div class=desktop-view><ul class="navbar-nav mr-auto"><li class=nav-item><a class=nav-link href=https://github.com/danb0b><i class=ti-github></i></a></li><li class=nav-item><a class=nav-link href=https://www.linkedin.com/in/dan-aukes-502995212/><i class=ti-linkedin></i></a></li></ul></div><a class="navbar-brand mx-auto desktop-view" href=https://www.danaukes.com/><img class=img-fluid src=https://www.danaukes.com/da-small.png alt="Dan Aukes"></a><ul class=navbar-nav><li class=nav-item><a class=nav-link href=https://www.danaukes.com/work-blog/>Work Blog</a></li><li class=nav-item><a class=nav-link href=https://www.danaukes.com/notebook/>Notebook</a></li><li class=nav-item><a class=nav-link href=https://www.danaukes.com/travel/>Travel</a></li><li class=nav-item><a class=nav-link href=https://www.danaukes.com/recipes/>Recipes</a></li><li class="nav-item dropdown"><a class="nav-link dropdown-toggle" href=# role=button data-toggle=dropdown aria-haspopup=true aria-expanded=false>Misc</a><div class=dropdown-menu><a class=dropdown-item href=https://www.danaukes.com/code/>Code</a>
<a class=dropdown-item href=https://www.danaukes.com/websites/>Websites</a>
<a class=dropdown-item href=https://www.danaukes.com/bookmarks/>Bookmarks</a></div></li></ul><form action=https://www.danaukes.com//search class=d-flex><input class="form-control me-2" id=search-query name=s type=s placeholder=Search aria-label=Search>
<button class="btn btn-outline-success" type=submit><i class="ti-search text-dark"></i></button></form></div></nav></div></header><section class=section-sm><div class=container><div class=row><div class="col-lg-8 mx-auto"><div class=text-center><nav aria-label=breadcrumb><ol class=breadcrumb><li class=breadcrumb-item><a href=https://www.danaukes.com/>Welcome</a></li><li class=breadcrumb-item><a href=https://www.danaukes.com/notebook/>Notebook</a></li><li class=breadcrumb-item><a href=https://www.danaukes.com/notebook/deprecated/>Deprecated Pages</a></li><li class="breadcrumb-item active"><a href=https://www.danaukes.com/notebook/deprecated/asus-issues/>ASUS Zenbook Issues</a></li></ol></nav></div><h2>ASUS Zenbook Issues</h2><div class="mb-1 post-meta"><span>By Dan Aukes</span></div><ul class=list-inline><li class="list-inline-item mb-3 mr-2 mt-1"><a class="d-block p-2 bg-primary text-white" href=/tags/asus class=text-primary>Asus</a></li><li class="list-inline-item mb-3 mr-2 mt-1"><a class="d-block p-2 bg-primary text-white" href=/tags/linux class=text-primary>Linux</a></li><li class="list-inline-item mb-3 mr-2 mt-1"><a class="d-block p-2 bg-primary text-white" href=/tags/ubuntu class=text-primary>Ubuntu</a></li></ul><div class="content mb-5"><p>I have an ASUS Zenbook UM425U, currently working great with Ubuntu 21.04 loaded. Upon installing Ubuntu 20.04, initially the keyboard worked but other aspects of the computer did not, such as being able to control screen brightness, fan speed, etc. After the kernel was automatically updated, however, suddently I was unable to use the keyboard, but intermittently. Each reboot might allow me or not. To add an additional wrinkle, I had also encrypted my hard drive using LUKS, meaning that if I was traveling or did not have access to an external keyboard, I would be locked out.</p><h2 id=install-a-compatible-kernel>Install a compatible Kernel</h2><p>The first thing I did was to manually install a kernel I could at least unlock my computer with. I followed the instructions <a href=https://www.how2shout.com/linux/install-linux-5-8-kernel-on-ubuntu-20-04-lts/>here</a> to get the linux 5.8.18 kernel installed.</p><p>List all kernels:</p><div class=highlight><pre tabindex=0 style=color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>dpkg --list <span style=color:#111>|</span> grep linux-image
</span></span></code></pre></div><h2 id=recompile-your-kernel>Recompile your Kernel</h2><p>The real solution, however, is discussed in this <a href="https://www.mail-archive.com/search?l=ubuntu-bugs@lists.ubuntu.com&amp;q=subject:%22%5C%5BBug+1943832%5C%5D+Re%5C%3A+Keyboard+doesn%27t+work+on+a+%5C%22cold+boot%5C%22+with+built%5C-in+%5C%22i8042+PC+Keyboard+controller%5C%22+%5C%28ASUS+UM425UA%5C%29%22&amp;o=newest&amp;f=1">chain of emails</a>, and the solution is discussed <a href=https://www.mail-archive.com/ubuntu-bugs@lists.ubuntu.com/msg5955393.html>here</a>.</p><ol><li><p>open <code>software-properties-gtk</code> and enable source code</p></li><li><p>Follow instructions to <a href=https://wiki.ubuntu.com/Kernel/BuildYourOwnKernel>build your own kernel</a></p><ol><li><p>get dependencies</p></li><li><p>get source ()</p><div class=highlight><pre tabindex=0 style=color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>apt <span style=color:#111>source</span> linux-image-unsigned-<span style=color:#00a8c8>$(</span>uname -r<span style=color:#00a8c8>)</span>
</span></span></code></pre></div></li><li><p>update configs</p><div class=highlight><pre tabindex=0 style=color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>chmod a+x debian/rules
</span></span><span style=display:flex><span>chmod a+x debian/scripts/*
</span></span><span style=display:flex><span>chmod a+x debian/scripts/misc/*
</span></span><span style=display:flex><span><span style=color:#111>LANG</span><span style=color:#f92672>=</span>C fakeroot debian/rules clean
</span></span><span style=display:flex><span><span style=color:#111>LANG</span><span style=color:#f92672>=</span>C fakeroot debian/rules editconfigs <span style=color:#75715e># you need to go through each (Y, Exit, Y, Exit..) or get a complaint about config late</span>
</span></span></code></pre></div></li><li><p>Use the advice from <a href=https://www.mail-archive.com/ubuntu-bugs@lists.ubuntu.com/msg5955393.html>here</a>, update yoru configuration (don&rsquo;t uncheck &ldquo;support for uevent&rdquo;)</p><div class=highlight><pre tabindex=0 style=color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-txt data-lang=txt><span style=display:flex><span>ASUS UM425UA internal keyboard doesn&#39;t work on a &#34;cold boot&#34; (first 
</span></span><span style=display:flex><span>power-on). It activates only after restart.
</span></span><span style=display:flex><span>  I noticed it when tried to boot live image of Ubuntu 20.04.3
</span></span><span style=display:flex><span>  This problem probably appeared with kernel version 5.9 or 5.10 because with 
</span></span><span style=display:flex><span>Ubuntu 20.04.2 live image (Linux 5.8) keyboard loads fine. Tried kernel 5.14 
</span></span><span style=display:flex><span>and it&#39;s still affected.
</span></span><span style=display:flex><span>  I tried to recompile kernels 5.11 &amp; 5.13 with SERIO_I8042 set as a module (as 
</span></span><span style=display:flex><span>suggested in an Arch Linux bug report) and keyboard now works from the first 
</span></span><span style=display:flex><span>start.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  In &#34;make config&#34; the changes are:
</span></span><span style=display:flex><span>  Device Drivers -&gt;
</span></span><span style=display:flex><span>    &gt; Generic Driver Options -&gt; [ ] Support for uevent #may slowdown boot, 
</span></span><span style=display:flex><span>needed only for U14.04
</span></span><span style=display:flex><span>    &gt; Input device support
</span></span><span style=display:flex><span>       &gt; Keyboards -&gt; [M] AT keyboard
</span></span><span style=display:flex><span>       &gt; Hardware I/O ports -&gt; [M] i8042 PC Keyboard controller
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  It changed such lines in config:
</span></span><span style=display:flex><span>  CONFIG_KEYBOARD_ATKBD=m
</span></span><span style=display:flex><span>  CONFIG_SERIO_I8042=m
</span></span><span style=display:flex><span>  CONFIG_SERIO_LIBPS2=m
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  References:
</span></span><span style=display:flex><span>  https://bugs.archlinux.org/task/70384
</span></span><span style=display:flex><span>  https://ubuntuforums.org/showthread.php?t=2459149
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>https://linux.org/threads/asus-zenbook-14-um425ua-keyboard-not-respond-during-cold-boot.33738/#post-133830
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  P.S. Other option which helped me was a GRUB parameter &#34;i8042.reset=1&#34; but it 
</span></span><span style=display:flex><span>had a positive effect only with kernel 5.11
</span></span></code></pre></div></li><li><p>These changes break the rules. Modify</p><div class=highlight><pre tabindex=0 style=color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>nano debian.master/config/annotations
</span></span></code></pre></div><ol><li>search for &ldquo;CONFIG_KEYBOARD_ATKBD&rdquo;, &ldquo;CONFIG_SERIO_I8042&rdquo;, and &ldquo;CONFIG_SERIO_LIBPS2&rdquo; and set amd64 option to &ldquo;m&rdquo; for each.</li></ol></li><li><p>Update version number so that the apt repository doesn&rsquo;t supersede it on the next upgrade (according to <a href=https://wiki.ubuntu.com/Kernel/BuildYourOwnKernel#Modifying_the_configuration>the ubuntu guide</a>)</p><ul><li>add a local version modifier like &ldquo;+test1&rdquo; to the end of the first version number in the debian.master/changelog file before building.</li><li>This will help identify your kernel when running as it also appears in uname -a.</li><li>Note that when a new Ubuntu kernel is released that will be newer than your kernel (which needs regenerating), so care is needed when upgrading.</li><li><strong>NOTE:</strong> do not attempt to use CONFIG_LOCALVERSION as this <em>will</em> break the build.</li></ul><div class=highlight><pre tabindex=0 style=color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>nano debian.master/changelog
</span></span></code></pre></div></li><li><p>build</p><div class=highlight><pre tabindex=0 style=color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#111>LANG</span><span style=color:#f92672>=</span>C fakeroot debian/rules clean
</span></span><span style=display:flex><span><span style=color:#75715e># quicker build:</span>
</span></span><span style=display:flex><span><span style=color:#111>LANG</span><span style=color:#f92672>=</span>C fakeroot debian/rules binary-headers binary-generic binary-perarch
</span></span><span style=display:flex><span><span style=color:#75715e># if you need linux-tools or lowlatency kernel, run instead:</span>
</span></span><span style=display:flex><span><span style=color:#111>LANG</span><span style=color:#f92672>=</span>C fakeroot debian/rules binary
</span></span></code></pre></div></li><li><p>Install the three-package set (on your build system, or on a different target system) with dpkg -i and then reboot:</p><div class=highlight><pre tabindex=0 style=color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>sudo dpkg -i linux*5.11.0*.deb
</span></span><span style=display:flex><span>sudo apt install -f <span style=color:#75715e>#to install any missing packages</span>
</span></span><span style=display:flex><span>sudo apt autoremove <span style=color:#75715e># to remove any unused packages</span>
</span></span><span style=display:flex><span>sudo reboot
</span></span></code></pre></div></li><li><p>Reinstall virtualbox-dkms</p><div class=highlight><pre tabindex=0 style=color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>sudo apt install --reinstall virtualbox-dkms 
</span></span><span style=display:flex><span>sudo modprobe vboxdrv
</span></span></code></pre></div></li></ol></li></ol><hr><h2 id=things-that-didnt-work>Things that didn&rsquo;t work</h2><h2 id=modify-initramfs>Modify initramfs</h2><p>find HID modules</p><div class=highlight><pre tabindex=0 style=color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>lsmod
</span></span></code></pre></div><p>add those modules to initramfs</p><div class=highlight><pre tabindex=0 style=color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>sudo nano /etc/initramfs-tools/modules
</span></span></code></pre></div><p>add one per line</p><div class=highlight><pre tabindex=0 style=color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e>#amdgpu </span>
</span></span><span style=display:flex><span>asus_wmi 
</span></span><span style=display:flex><span>asus_nb_wmi
</span></span><span style=display:flex><span>atkbd 
</span></span><span style=display:flex><span>dm_crypt 
</span></span><span style=display:flex><span>ext4 
</span></span><span style=display:flex><span>fat 
</span></span><span style=display:flex><span>i2c_hid 
</span></span><span style=display:flex><span>i8042
</span></span><span style=display:flex><span>ohci_pci
</span></span><span style=display:flex><span>xhci_pci
</span></span><span style=display:flex><span>xhci_pci_renesas
</span></span><span style=display:flex><span>edac_mce_amd
</span></span><span style=display:flex><span>kvm_amd
</span></span><span style=display:flex><span>kvm
</span></span><span style=display:flex><span>serio_raw
</span></span><span style=display:flex><span>usbcore
</span></span><span style=display:flex><span>uhci_hcd
</span></span><span style=display:flex><span>ehci_hcd
</span></span><span style=display:flex><span>usbhid
</span></span></code></pre></div><p>update initramfs:</p><div class=highlight><pre tabindex=0 style=color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>sudo update-initramfs -u -k all
</span></span></code></pre></div><h2 id=blacklist-amdgpu>Blacklist <code>amdgpu</code></h2><p>when doing update-initramfs in kernel 5.11.0-31, there are some messages about amdgpu missing drivers</p><p>Add the following line to /etc/modprobe.d/blacklist.conf.</p><div class=highlight><pre tabindex=0 style=color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>blacklist amdgpu
</span></span></code></pre></div><p>As initramfs contains modprobe configuration, update the initramfs and reboot:</p><div class=highlight><pre tabindex=0 style=color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>sudo update-initramfs -u -k all
</span></span></code></pre></div><p>Check whether the driver blacklisted or not, the following command should output nothing.</p><div class=highlight><pre tabindex=0 style=color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>lsmod <span style=color:#111>|</span> grep amdgpu
</span></span></code></pre></div><p>But this kills hdmi&mldr;</p></div></div></div></div></section><footer class=text-capitalize><div class=container><div class="row justify-content-center"><div class="col-12 border-top py-4 text-center"></div><div class="col-lg-4 col-sm-6 mb-5 text-center"><h6 class=mb-4>Contact Me</h6><ul class=list-unstyled><li class=mb-3><i class="ti-location-pin mr-3 text-primary"></i>Arizona, USA</li></li></ul></div><div class="col-lg-4 col-sm-6 mb-5 text-center"><h6 class=mb-4>External</h6><ul class=list-unstyled><li class=mb-3><a class=text-dark href=https://github.com/danb0b>personal github</a></li><li class=mb-3><a class=text-dark href=https://www.linkedin.com/in/dan-aukes-502995212/>linkedin</a></li></ul></div><div class="col-lg-4 col-sm-6 mb-5 text-center"><h6 class=mb-4>Quick Links</h6><ul class=list-unstyled><li class=mb-3><a class=text-dark href=https://www.danaukes.com/about/>About</a></li><li class=mb-3><a class=text-dark href=https://www.danaukes.com/about/teaching/>Teaching</a></li><li class=mb-3><a class=text-dark href=https://www.danaukes.com/contact/>Contact</a></li><li class=mb-3><a class=text-dark href=https://www.danaukes.com/calendar/>Calendar</a></li></ul></div><div class="col-12 mb-5 text-center"><a href=https://www.danaukes.com/><img src=https://www.danaukes.com/da-small.png alt="Dan Aukes"></a></div><div class="col-12 mb-5 text-center"><p>| copyright © 2025 Daniel Aukes. All Rights Reserved. |</p><p><a href=https://github.com/danb0b/danb0b.github.io/edit/master/content/notebook/deprecated/asus-issues.md>Edit this Page</a></p></div></div></div></footer><script>var indexURL="https://www.danaukes.com/index.json"</script><script src=https://www.danaukes.com/plugins/glightbox/js/glightbox.js></script><script src=https://www.danaukes.com/plugins/jQuery/jquery.min.js></script><script src=https://www.danaukes.com/plugins/bootstrap/bootstrap.min.js></script><script src=https://www.danaukes.com/plugins/slick/slick.min.js></script><script src=https://www.danaukes.com/plugins/venobox/venobox.min.js></script><script src=https://www.danaukes.com/plugins/search/fuse.min.js></script><script src=https://www.danaukes.com/plugins/search/mark.js></script><script src=https://www.danaukes.com/plugins/search/search.js></script><script src=https://www.danaukes.com/js/script.min.js></script><script>var lightboxDescription,lightboxVideo,lightboxInlineIframe,lightbox=GLightbox();lightbox.on("open",e=>{console.log("lightbox opened")}),lightboxDescription=GLightbox({selector:".glightbox2"}),lightboxVideo=GLightbox({selector:".glightbox3"}),lightboxVideo.on("slide_changed",({prev:e,current:t})=>{console.log("Prev slide",e),console.log("Current slide",t);const{slideIndex:s,slideNode:o,slideConfig:i,player:n}=t;n&&(n.ready||n.on("ready",e=>{}),n.on("play",e=>{console.log("Started play")}),n.on("volumechange",e=>{console.log("Volume change")}),n.on("ended",e=>{console.log("Video ended")}))}),lightboxInlineIframe=GLightbox({selector:".glightbox4"})</script></body></html>