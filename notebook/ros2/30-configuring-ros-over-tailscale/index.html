<!doctype html><html lang=en-us><head><meta charset=utf-8><title>Configuring ROS2 over a Tailscale VPN on Ubuntu | Dan Aukes </title><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1"><meta name=description content="Dan Aukes' personal website"><meta name=author content="Dan Aukes"><meta name=generator content="Hugo 0.125.7"><link rel=stylesheet href=https://www.danaukes.com/plugins/glightbox/css/glightbox.css><link rel=stylesheet href=https://www.danaukes.com/plugins/bootstrap/bootstrap.min.css><link rel=stylesheet href=https://www.danaukes.com/plugins/slick/slick.css><link rel=stylesheet href=https://www.danaukes.com/plugins/themify-icons/themify-icons.css><link rel=stylesheet href=https://www.danaukes.com/plugins/venobox/venobox.css><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/bootstrap-icons@1.5.0/font/bootstrap-icons.css><link rel=stylesheet href=https://www.danaukes.com/scss/style.min.css media=screen><link rel="shortcut icon" href=https://www.danaukes.com/images/favicon.png type=image/x-icon><link rel=icon href=https://www.danaukes.com/images/favicon.png type=image/x-icon><script>(function(e,t,n,s,o,i,a){e.GoogleAnalyticsObject=o,e[o]=e[o]||function(){(e[o].q=e[o].q||[]).push(arguments)},e[o].l=1*new Date,i=t.createElement(n),a=t.getElementsByTagName(n)[0],i.async=1,i.src=s,a.parentNode.insertBefore(i,a)})(window,document,"script","//www.google-analytics.com/analytics.js","ga"),ga("create","","auto"),ga("send","pageview")</script><script>MathJax={tex:{inlineMath:[["$","$"],["\\(","\\)"]],displayMath:[["$$","$$"],["\\[","\\]"]],processEscapes:!0,processEnvironments:!0},options:{skipHtmlTags:["script","noscript","style","textarea","pre"]}},window.addEventListener("load",e=>{document.querySelectorAll("mjx-container").forEach(function(e){e.parentElement.classList+="has-jax"})})</script><script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script><script type=text/javascript id=MathJax-script async src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script></head><body><div class=preloader></div><header class=navigation><div class=container><nav class="navbar navbar-expand-lg navbar-white bg-transparent border-bottom pl-0"><a class="navbar-brand mobile-view" href=https://www.danaukes.com/><img class=img-fluid src=https://www.danaukes.com/da-small.png alt="Dan Aukes"></a>
<button class="navbar-toggler border-0" type=button data-toggle=collapse data-target=#navigation>
<i class=ti-menu></i></button><div class="collapse navbar-collapse text-center" id=navigation><div class=desktop-view><ul class="navbar-nav mr-auto"><li class=nav-item><a class=nav-link href=https://github.com/danb0b><i class=ti-github></i></a></li><li class=nav-item><a class=nav-link href=https://www.linkedin.com/in/dan-aukes-502995212/><i class=ti-linkedin></i></a></li></ul></div><a class="navbar-brand mx-auto desktop-view" href=https://www.danaukes.com/><img class=img-fluid src=https://www.danaukes.com/da-small.png alt="Dan Aukes"></a><ul class=navbar-nav><li class=nav-item><a class=nav-link href=https://www.danaukes.com/work-blog/>Work Blog</a></li><li class=nav-item><a class=nav-link href=https://www.danaukes.com/notebook/>Notebook</a></li><li class=nav-item><a class=nav-link href=https://www.danaukes.com/travel/>Travel</a></li><li class=nav-item><a class=nav-link href=https://www.danaukes.com/recipes/>Recipes</a></li><li class="nav-item dropdown"><a class="nav-link dropdown-toggle" href=# role=button data-toggle=dropdown aria-haspopup=true aria-expanded=false>Misc</a><div class=dropdown-menu><a class=dropdown-item href=https://www.danaukes.com/code/>Code</a>
<a class=dropdown-item href=https://www.danaukes.com/websites/>Websites</a>
<a class=dropdown-item href=https://www.danaukes.com/bookmarks/>Bookmarks</a></div></li></ul><form action=https://www.danaukes.com//search class=d-flex><input class="form-control me-2" id=search-query name=s type=s placeholder=Search aria-label=Search>
<button class="btn btn-outline-success" type=submit><i class="ti-search text-dark"></i></button></form></div></nav></div></header><section class=section-sm><div class=container><div class=row><div class="col-lg-8 mx-auto"><div class=text-center><nav aria-label=breadcrumb><ol class=breadcrumb><li class=breadcrumb-item><a href=https://www.danaukes.com/>Welcome</a></li><li class=breadcrumb-item><a href=https://www.danaukes.com/notebook/>Notebook</a></li><li class=breadcrumb-item><a href=https://www.danaukes.com/notebook/ros2/>ROS2 Tutorial Pages</a></li><li class="breadcrumb-item active"><a href=https://www.danaukes.com/notebook/ros2/30-configuring-ros-over-tailscale/>Configuring ROS2 over a Tailscale VPN on Ubuntu</a></li></ol></nav></div><h2>Configuring ROS2 over a Tailscale VPN on Ubuntu</h2><div class="mb-1 post-meta"><span>By Dan Aukes</span></div><ul class=list-inline><li class="list-inline-item mb-3 mr-2 mt-1"><a class="d-block p-2 bg-primary text-white" href=/tags/ros2 class=text-primary>Ros2</a></li><li class="list-inline-item mb-3 mr-2 mt-1"><a class="d-block p-2 bg-primary text-white" href=/tags/ubuntu class=text-primary>Ubuntu</a></li><li class="list-inline-item mb-3 mr-2 mt-1"><a class="d-block p-2 bg-primary text-white" href=/tags/linux class=text-primary>Linux</a></li><li class="list-inline-item mb-3 mr-2 mt-1"><a class="d-block p-2 bg-primary text-white" href=/tags/tailscale class=text-primary>Tailscale</a></li></ul><div class="content mb-5"><h2 id=prerequisites>Prerequisites</h2><p>This tutorial assumes you have already installed ROS2 on a PC, Raspberry pi, or virtual machine running Ubuntu. For those tutorials, please see:</p><ul><li><a href=/notebook/ros2/installing-ros2-on-a-rpiz2w/>Installing ROS2 on a Raspberry Pi</a></li><li><a href=/notebook/ros2/installing-ros2-on-a-vm/>Installing ROS2 on a Virtual Machine</a></li></ul><h2 id=instructions>Instructions</h2><h3 id=installing-and-using-tailscale>Installing and using tailscale</h3><p>First, go to the administrative interface at tailscale.com and ensure that the magicdns feature is enabled.</p><p>Then in a terminal window, download and run the install script straight from tailscale:</p><div class=highlight><pre tabindex=0 style=color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>curl -fsSL https://tailscale.com/install.sh <span style=color:#111>|</span> sh
</span></span></code></pre></div><p>Before starting up, adjust some settings to enable other features</p><div class=highlight><pre tabindex=0 style=color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>sudo tailscale <span style=color:#111>set</span> --operator<span style=color:#f92672>=</span><span style=color:#111>$USER</span> -accept-dns<span style=color:#f92672>=</span><span style=color:#111>true</span> --accept-routes<span style=color:#f92672>=</span><span style=color:#111>true</span> 
</span></span></code></pre></div><p>Follow the instructions and link provided on the terimal interface to register your new computer with your tailscale account. you can do this in the device itself, or copy the link to the browser in your own pc if connecting remotely.</p><p>Finally, check that your install works:</p><div class=highlight><pre tabindex=0 style=color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>tailscale status
</span></span></code></pre></div><p>You should see your computer listed</p><h3 id=set-up-fastrtps>Set up fastrtps</h3><div class=highlight><pre tabindex=0 style=color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>sudo apt install ros-humble-rmw-fastrtps-cpp
</span></span></code></pre></div><p>Create a configuration file for fastrtps. replace <code>[HOSTNAME1]</code> and <code>[HOSTNAME2]</code> with the hostname or IP address of your computers as seen in the tailscale administrative interface. If you anticipate the ip address changing, for example if one of the machines is a docker container without ip address permanence enabled, it is suggested to use the hostname. This is only possible with &ldquo;magicdns&rdquo; enabled.</p><div class=highlight><pre tabindex=0 style=color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>cat <span style=color:#d88200>&lt;&lt;EOT | sudo tee /etc/fast_ts.xml
</span></span></span><span style=display:flex><span><span style=color:#d88200>&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34; ?&gt;
</span></span></span><span style=display:flex><span><span style=color:#d88200>&lt;profiles xmlns=&#34;http://www.eprosima.com/XMLSchemas/fastRTPS_Profiles&#34;&gt;
</span></span></span><span style=display:flex><span><span style=color:#d88200>    &lt;transport_descriptors&gt;
</span></span></span><span style=display:flex><span><span style=color:#d88200>        &lt;transport_descriptor&gt;
</span></span></span><span style=display:flex><span><span style=color:#d88200>            &lt;transport_id&gt;TailscaleTransport&lt;/transport_id&gt;
</span></span></span><span style=display:flex><span><span style=color:#d88200>            &lt;type&gt;UDPv4&lt;/type&gt;
</span></span></span><span style=display:flex><span><span style=color:#d88200>        &lt;/transport_descriptor&gt;
</span></span></span><span style=display:flex><span><span style=color:#d88200>    &lt;/transport_descriptors&gt;
</span></span></span><span style=display:flex><span><span style=color:#d88200>    &lt;participant profile_name=&#34;TailscaleSimple&#34; is_default_profile=&#34;true&#34;&gt;
</span></span></span><span style=display:flex><span><span style=color:#d88200>        &lt;rtps&gt;
</span></span></span><span style=display:flex><span><span style=color:#d88200>            &lt;userTransports&gt;
</span></span></span><span style=display:flex><span><span style=color:#d88200>                &lt;transport_id&gt;TailscaleTransport&lt;/transport_id&gt;
</span></span></span><span style=display:flex><span><span style=color:#d88200>            &lt;/userTransports&gt;
</span></span></span><span style=display:flex><span><span style=color:#d88200>            &lt;useBuiltinTransports&gt;true&lt;/useBuiltinTransports&gt;
</span></span></span><span style=display:flex><span><span style=color:#d88200>            &lt;builtin&gt;
</span></span></span><span style=display:flex><span><span style=color:#d88200>                &lt;initialPeersList&gt;
</span></span></span><span style=display:flex><span><span style=color:#d88200>                    &lt;locator&gt;
</span></span></span><span style=display:flex><span><span style=color:#d88200>                        &lt;udpv4&gt;
</span></span></span><span style=display:flex><span><span style=color:#d88200>                            &lt;address&gt;[HOSTNAME1]&lt;/address&gt;
</span></span></span><span style=display:flex><span><span style=color:#d88200>                        &lt;/udpv4&gt;
</span></span></span><span style=display:flex><span><span style=color:#d88200>                    &lt;/locator&gt;
</span></span></span><span style=display:flex><span><span style=color:#d88200>                    &lt;locator&gt;
</span></span></span><span style=display:flex><span><span style=color:#d88200>                        &lt;udpv4&gt;
</span></span></span><span style=display:flex><span><span style=color:#d88200>                            &lt;address&gt;[HOSTNAME2]&lt;/address&gt; 
</span></span></span><span style=display:flex><span><span style=color:#d88200>                        &lt;/udpv4&gt;
</span></span></span><span style=display:flex><span><span style=color:#d88200>                    &lt;/locator&gt;
</span></span></span><span style=display:flex><span><span style=color:#d88200>                &lt;/initialPeersList&gt;
</span></span></span><span style=display:flex><span><span style=color:#d88200>            &lt;/builtin&gt;
</span></span></span><span style=display:flex><span><span style=color:#d88200>        &lt;/rtps&gt;
</span></span></span><span style=display:flex><span><span style=color:#d88200>    &lt;/participant&gt;
</span></span></span><span style=display:flex><span><span style=color:#d88200>&lt;/profiles&gt;
</span></span></span><span style=display:flex><span><span style=color:#d88200>EOT</span>
</span></span></code></pre></div><p>Note: you can add more peers as needed to add more devices to your ROS2 network:</p><div class=highlight><pre tabindex=0 style=color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#f92672>&lt;locator&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;udpv4&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>&lt;address&gt;</span>[HOSTNAMEX]<span style=color:#f92672>&lt;/address&gt;</span> 
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;/udpv4&gt;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>&lt;/locator&gt;</span>
</span></span></code></pre></div><p>Next, modify .bashrc</p><div class=highlight><pre tabindex=0 style=color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>sudo nano ~/.bashrc
</span></span></code></pre></div><p>it should look like the following example. The new lines should ideally be added before the <code>source /opt/ros/humble/setup.bash</code> line:</p><div class=highlight><pre tabindex=0 style=color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e>#....there will be other code above this</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#111>export</span> <span style=color:#111>RMW_IMPLEMENTATION</span><span style=color:#f92672>=</span>rmw_fastrtps_cpp
</span></span><span style=display:flex><span><span style=color:#111>FASTRTPS_DEFAULT_PROFILES_FILE</span><span style=color:#f92672>=</span>/etc/fast.xml
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>#... the following lines should already be here.  Don&#39;t modify them</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#111>export</span> <span style=color:#111>ROS_DOMAIN_ID</span><span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span><span style=color:#111>export</span> <span style=color:#111>ROS_LOCALHOST_ONLY</span><span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span><span style=color:#111>source</span> /opt/ros/humble/setup.bash
</span></span></code></pre></div><p>Next, save and close the file. In a terminal, type</p><div class=highlight><pre tabindex=0 style=color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#111>source</span> ~/.bashrc
</span></span></code></pre></div><p>even better, close and reopen your terminal window, or if you really want to test your changes, restart the pc.</p><div class=highlight><pre tabindex=0 style=color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>sudo reboot now
</span></span></code></pre></div><p>Once restarted, In a new terminal window,</p><div class=highlight><pre tabindex=0 style=color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>ros2 run demo_nodes_cpp listener
</span></span></code></pre></div><p>in a separate terminal window, type</p><div class=highlight><pre tabindex=0 style=color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>ros2 run demo_nodes_cpp talker
</span></span></code></pre></div><p>Finally, open up a separate computer that has been set up to work over tailscale and is added to the fast.xml config file. It should work, no matter how it&rsquo;s connected to the internet!</p><h2 id=external-resources>External Resources</h2><p><a href=https://adityakamath.hashnode.dev/ros-2-and-vpns>https://adityakamath.hashnode.dev/ros-2-and-vpns</a></p><h3 id=oter-resources>Oter Resources</h3><ul><li><a href=https://stackoverflow.com/questions/55723797/how-to-join-the-default-bridge-and-user-defined-bridge-with-docker-compose-v3>https://stackoverflow.com/questions/55723797/how-to-join-the-default-bridge-and-user-defined-bridge-with-docker-compose-v3</a></li><li><a href=https://github.com/docker/compose/issues/3012>https://github.com/docker/compose/issues/3012</a></li><li><a href=https://docs.docker.com/compose/compose-file/#network-mode>https://docs.docker.com/compose/compose-file/#network-mode</a></li><li><a href=https://tailscale.com/kb/1247/funnel-examples>https://tailscale.com/kb/1247/funnel-examples</a></li><li><a href=https://forum.tailscale.com/t/connecting-to-a-service-on-a-docker-container-through-tailscale/756>https://forum.tailscale.com/t/connecting-to-a-service-on-a-docker-container-through-tailscale/756</a></li><li><a href=https://forum.tailscale.com/t/using-tailscale-from-docker-containers/127>https://forum.tailscale.com/t/using-tailscale-from-docker-containers/127</a></li><li><a href=https://web.whatsapp.com/>https://web.whatsapp.com/</a></li><li><a href=https://docs.docker.com/network/>https://docs.docker.com/network/</a></li><li><a href="https://duckduckgo.com/?q=using+ros2+over+tailscale&amp;t=ffab&amp;ia=web">https://duckduckgo.com/?q=using+ros2+over+tailscale&amp;t=ffab&amp;ia=web</a></li><li><a href=https://adityakamath.hashnode.dev/ros-2-and-vpns>https://adityakamath.hashnode.dev/ros-2-and-vpns</a></li><li><a href="https://duckduckgo.com/?t=ffab&amp;q=use+tailscale+with+docker+services&amp;ia=web">https://duckduckgo.com/?t=ffab&amp;q=use+tailscale+with+docker+services&amp;ia=web</a></li><li><a href=https://tailscale.dev/blog/docker-mod-tailscale>https://tailscale.dev/blog/docker-mod-tailscale</a></li><li><a href=https://rnorth.org/tailscale-docker/>https://rnorth.org/tailscale-docker/</a></li><li><a href=https://github.com/tailscale/tailscale/issues/504#issuecomment-787224358>https://github.com/tailscale/tailscale/issues/504#issuecomment-787224358</a></li><li><a href=https://github.com/tailscale/tailscale/blob/main/Dockerfile>https://github.com/tailscale/tailscale/blob/main/Dockerfile</a></li><li><a href=https://github.com/tailscale/tailscale/issues/295>https://github.com/tailscale/tailscale/issues/295</a></li><li><a href=https://hub.docker.com/r/tailscale/tailscale>https://hub.docker.com/r/tailscale/tailscale</a></li><li><a href=https://tailscale.com/blog/kubecon-21>https://tailscale.com/blog/kubecon-21</a></li><li><a href=https://docs.docker.com/network/network-tutorial-standalone/>https://docs.docker.com/network/network-tutorial-standalone/</a></li><li><a href=https://docs.docker.com/compose/networking/>https://docs.docker.com/compose/networking/</a></li><li><a href=https://docs.docker.com/engine/extend/plugins_network/>https://docs.docker.com/engine/extend/plugins_network/</a></li><li><a href=https://tailscale.com/kb/1112/userspace-networking>https://tailscale.com/kb/1112/userspace-networking</a></li><li><a href=https://tailscale.com/kb/1278/tailscaled>https://tailscale.com/kb/1278/tailscaled</a></li><li><a href=https://www.howtogeek.com/devops/how-to-use-multi-threaded-processing-in-bash-scripts/>https://www.howtogeek.com/devops/how-to-use-multi-threaded-processing-in-bash-scripts/</a></li></ul></div></div></div></div></section><footer class=text-capitalize><div class=container><div class="row justify-content-center"><div class="col-12 border-top py-4 text-center"></div><div class="col-lg-4 col-sm-6 mb-5 text-center"><h6 class=mb-4>Contact Me</h6><ul class=list-unstyled><li class=mb-3><i class="ti-location-pin mr-3 text-primary"></i>Arizona, USA</li></li></ul></div><div class="col-lg-4 col-sm-6 mb-5 text-center"><h6 class=mb-4>External</h6><ul class=list-unstyled><li class=mb-3><a class=text-dark href=https://github.com/danb0b>personal github</a></li><li class=mb-3><a class=text-dark href=https://www.linkedin.com/in/dan-aukes-502995212/>linkedin</a></li></ul></div><div class="col-lg-4 col-sm-6 mb-5 text-center"><h6 class=mb-4>Quick Links</h6><ul class=list-unstyled><li class=mb-3><a class=text-dark href=https://www.danaukes.com/about/>About</a></li><li class=mb-3><a class=text-dark href=https://idealab-asu.slack.com>IDEAlab Slack</a></li><li class=mb-3><a class=text-dark href=https://www.danaukes.com/contact/>Contact</a></li><li class=mb-3><a class=text-dark href=https://scram-workspace.slack.com>SCRAMbots</a></li><li class=mb-3><a class=text-dark href=https://www.danaukes.com/calendar/>Calendar</a></li><li class=mb-3><a class=text-dark href=https://kaiteki-asu.slack.com>Kaiteki</a></li></ul></div><div class="col-12 mb-5 text-center"><a href=https://www.danaukes.com/><img src=https://www.danaukes.com/da-small.png alt="Dan Aukes"></a></div><div class="col-12 mb-5 text-center"><p>| copyright Â© 2023 Daniel Aukes. All Rights Reserved. |</p><p><a href=https://github.com/danb0b/danb0b.github.io/edit/master/content/notebook/ros2/30-configuring-ros-over-tailscale.md>Edit this Page</a></p></div></div></div></footer><script>var indexURL="https://www.danaukes.com/index.json"</script><script src=https://www.danaukes.com/plugins/glightbox/js/glightbox.js></script><script src=https://www.danaukes.com/plugins/jQuery/jquery.min.js></script><script src=https://www.danaukes.com/plugins/bootstrap/bootstrap.min.js></script><script src=https://www.danaukes.com/plugins/slick/slick.min.js></script><script src=https://www.danaukes.com/plugins/venobox/venobox.min.js></script><script src=https://www.danaukes.com/plugins/search/fuse.min.js></script><script src=https://www.danaukes.com/plugins/search/mark.js></script><script src=https://www.danaukes.com/plugins/search/search.js></script><script src=https://www.danaukes.com/js/script.min.js></script><script>var lightboxDescription,lightboxVideo,lightboxInlineIframe,lightbox=GLightbox();lightbox.on("open",e=>{console.log("lightbox opened")}),lightboxDescription=GLightbox({selector:".glightbox2"}),lightboxVideo=GLightbox({selector:".glightbox3"}),lightboxVideo.on("slide_changed",({prev:e,current:t})=>{console.log("Prev slide",e),console.log("Current slide",t);const{slideIndex:s,slideNode:o,slideConfig:i,player:n}=t;n&&(n.ready||n.on("ready",e=>{}),n.on("play",e=>{console.log("Started play")}),n.on("volumechange",e=>{console.log("Volume change")}),n.on("ended",e=>{console.log("Video ended")}))}),lightboxInlineIframe=GLightbox({selector:".glightbox4"})</script></body></html>